import{u as E,a as m,s as C,j as e,d as D,b as M,r as i,c as I,e as B,f as L,g as P,h as z,i as F,k as O,l as U,m as q,B as H}from"./index-bdd633cb.js";import{M as J,a as R,b as S,S as K,T as V,C as _,c as G,B as k,N as Q,P as W,A as X,H as Y}from"./index-91aad61c.js";import{u as Z,D as ee}from"./index.esm-549e5546.js";function te({setShowModal:a,id:t}){const g=E(),o=m(C);function j(){g(D({id:t,token:o.token})),a(!1),window.scrollTo({top:0,behavior:"smooth"})}return e.jsx(J,{id:"modal",children:e.jsxs(R,{children:[e.jsx("p",{style:{marginBottom:"10px"},children:"Sigurno želiš da obrišeš članak?"}),e.jsx(S,{$bg:"green",$float:"left",onClick:()=>a(!1),children:"Ne"}),e.jsx(S,{$bg:"green",$float:"right",onClick:j,children:"Da"})]})})}function se(){var y,A;const{id:a}=M(),[t,g]=i.useState(""),o=m(C),j=m(I),r=B(),l=E(),x=m(L),c=P(),[w,v]=i.useState(!1),b=m(z),{register:p,handleSubmit:N,formState:{errors:d},reset:f,control:T}=Z({mode:"onBlur",defaultValues:i.useMemo(()=>{var n;return{title:t==null?void 0:t.title,content:t==null?void 0:t.content,categories:(n=t==null?void 0:t.categories)==null?void 0:n.map(u=>u.name).join(", ")}},[t])});function $(s){var n;if(s.title===t.title&&s.content===t.content&&JSON.stringify(s.categories)===JSON.stringify(t.categories)){r({content:"Ništa nije izmenjeno",variety:"error"});return}if(o&&o.id===t.authorId){const u={id:t.id,title:s.title,content:s.content,authorId:o.id,categories:(n=s.categories)!=null&&n.length?s.categories.split(", ").map(h=>h[0].toUpperCase()+h.slice(1)):[]};l(U({newData:u,token:o.token}))}else r({content:"Samo autori članaka ih mogu menjati",variety:"error"})}return i.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[l]),i.useEffect(()=>{var s;f({title:t==null?void 0:t.title,content:t==null?void 0:t.content,categories:(s=t==null?void 0:t.categories)==null?void 0:s.map(n=>n.name).join(", ")})},[t,f]),i.useEffect(()=>{async function s(){try{const n=await q.get(`${H}/${a}`);g(n.data)}catch(n){r({content:n.response.data.error,variety:"error"})}}a&&s()},[a,r,c]),i.useEffect(()=>{var s,n,u,h;(s=d.title)!=null&&s.message&&r({content:(n=d.title)==null?void 0:n.message,variety:"error"}),(u=d.content)!=null&&u.message&&r({content:(h=d.content)==null?void 0:h.message,variety:"error"})},[r,(y=d.title)==null?void 0:y.message,(A=d.content)==null?void 0:A.message]),i.useEffect(()=>{j&&r({content:j,variety:"error"})},[j,r]),i.useEffect(()=>{x&&(r({content:"Članak je uspešno izmenjen",variety:"success"}),setTimeout(()=>{c(`/articles/${x}`),l(F())},7e3))},[r,f,c,x,l]),i.useEffect(()=>{b&&(c("/"),r({content:"Članak je obrisan",variety:"success"}),setTimeout(()=>l(O()),7e3))},[b,c,l,r]),e.jsxs(K,{onSubmit:N($),children:[e.jsx(V,{type:"text",placeholder:"Naslov članka",...p("title",{required:!0,minLength:{value:1,message:"Naslov članka mora imati najmanje 1 karakter."}})}),e.jsx(_,{className:"scroll scrollInput",rows:"45",placeholder:"Sadržaj članka",...p("content",{required:!0,minLength:{value:10,message:"Sadržaj članka mora imati najmanje 10 karaktera."}})}),e.jsx(G,{type:"text",placeholder:"Kategorije",...p("categories")}),e.jsx(k,{$bg:"blue",type:"button",onClick:()=>c(-1),children:"Poništi"}),e.jsx(k,{$bg:"green",type:"submit",children:"Sačuvaj"}),e.jsx(k,{$bg:"red",type:"button",onClick:()=>v(!0),children:"Obriši"}),w&&e.jsx(te,{setShowModal:v,id:a}),e.jsx(ee,{control:T})]})}function ae(){return e.jsxs(Q,{children:[e.jsx(W,{children:"Izmena članka"}),e.jsxs(X,{children:[e.jsx(se,{}),e.jsxs(Y,{children:[e.jsx("h4",{children:"Uputstvo za formatiranje"}),e.jsx("br",{}),e.jsx("p",{children:"## Podnaslov"}),e.jsx("br",{}),e.jsx("p",{children:"### Podpodnaslov"}),e.jsx("br",{}),e.jsx("p",{children:"Tekst"}),e.jsx("br",{}),e.jsxs("p",{children:["(",e.jsx("i",{children:"postavljanje slike"}),")"]}),e.jsx("p",{children:"|     |"}),e.jsx("p",{children:"|:---:|"}),e.jsxs("p",{children:["|![",e.jsx("i",{children:"opis slike"}),"](",e.jsx("i",{children:"link ka slici"}),")|"]}),e.jsxs("p",{children:["|",e.jsx("i",{children:"naslov slike"}),"|"]}),e.jsx("br",{}),e.jsxs("p",{children:["(",e.jsx("i",{children:"linkovanje"}),")"]}),e.jsxs("p",{children:["[",e.jsx("i",{children:"tekst linka"}),"](",e.jsx("i",{children:"/articles/:id"}),")"]})]})]})]})}export{ae as default};
