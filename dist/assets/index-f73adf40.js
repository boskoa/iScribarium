import{u as E,b as h,d as C,j as e,e as M,f as T,g as I,h as B,r as D,i as L,k as P,a as z,B as F}from"./index-2782feee.js";import{NewArticleContainer as O,PageTitle as U,ArticleContainer as q,Helper as J}from"./index-8bfc1893.js";import{u as R,a as H}from"./useTimedMessage-d0ae0a00.js";import{r as i}from"./echarts-63d4abac.js";import{M as K,a as V,b as S,S as _,T as G,C as Q,c as W,B as k}from"./NewArticleForm-66c1136f.js";import{b as X,u as Y}from"./react-router-dom-50fe5a57.js";import"./zrender-1584b751.js";function Z({setShowModal:o,id:t}){const p=E(),a=h(C);function j(){p(M({id:t,token:a.token})),o(!1),window.scrollTo({top:0,behavior:"smooth"})}return e.jsx(K,{id:"modal",children:e.jsxs(V,{children:[e.jsx("p",{style:{marginBottom:"10px"},children:"Sigurno želiš da obrišeš članak?"}),e.jsx(S,{$bg:"green",$float:"left",onClick:()=>o(!1),children:"Ne"}),e.jsx(S,{$bg:"green",$float:"right",onClick:j,children:"Da"})]})})}function ee(){var y,A;const{id:o}=X(),[t,p]=i.useState(""),a=h(C),j=h(T),r=R(),l=E(),g=h(I),c=Y(),[w,v]=i.useState(!1),b=h(B),{register:x,handleSubmit:N,formState:{errors:d},reset:f}=H({mode:"onBlur",defaultValues:i.useMemo(()=>{var n;return{title:t==null?void 0:t.title,content:t==null?void 0:t.content,categories:(n=t==null?void 0:t.categories)==null?void 0:n.map(u=>u.name).join(", ")}},[t])});function $(s){var n;if(s.title===t.title&&s.content===t.content&&JSON.stringify(s.categories)===JSON.stringify(t.categories)){r({content:"Ništa nije izmenjeno",variety:"error"});return}if(a&&a.id===t.authorId){const u={id:t.id,title:s.title,content:s.content,authorId:a.id,categories:(n=s.categories)!=null&&n.length?s.categories.split(", ").map(m=>m[0].toUpperCase()+m.slice(1)):[]};l(P({newData:u,token:a.token}))}else r({content:"Samo autori članaka ih mogu menjati",variety:"error"})}return i.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[l]),i.useEffect(()=>{var s;f({title:t==null?void 0:t.title,content:t==null?void 0:t.content,categories:(s=t==null?void 0:t.categories)==null?void 0:s.map(n=>n.name).join(", ")})},[t,f]),i.useEffect(()=>{async function s(){try{const n=await z.get(`${F}/${o}`);p(n.data)}catch(n){r({content:n.response.data.error,variety:"error"})}}o&&s()},[o,r,c]),i.useEffect(()=>{var s,n,u,m;(s=d.title)!=null&&s.message&&r({content:(n=d.title)==null?void 0:n.message,variety:"error"}),(u=d.content)!=null&&u.message&&r({content:(m=d.content)==null?void 0:m.message,variety:"error"})},[r,(y=d.title)==null?void 0:y.message,(A=d.content)==null?void 0:A.message]),i.useEffect(()=>{j&&r({content:j,variety:"error"})},[j,r]),i.useEffect(()=>{g&&(r({content:"Članak je uspešno izmenjen",variety:"success"}),setTimeout(()=>{c(`/articles/${g}`),l(D())},7e3))},[r,f,c,g,l]),i.useEffect(()=>{b&&(c("/"),r({content:"Članak je obrisan",variety:"success"}),setTimeout(()=>l(L()),7e3))},[b,c,l,r]),e.jsxs(_,{onSubmit:N($),children:[e.jsx(G,{type:"text",placeholder:"Naslov članka",...x("title",{required:!0,minLength:{value:1,message:"Naslov članka mora imati najmanje 1 karakter."}})}),e.jsx(Q,{className:"scroll scrollInput",rows:"45",placeholder:"Sadržaj članka",...x("content",{required:!0,minLength:{value:10,message:"Sadržaj članka mora imati najmanje 10 karaktera."}})}),e.jsx(W,{type:"text",placeholder:"Kategorije",...x("categories")}),e.jsx(k,{$bg:"blue",type:"button",onClick:()=>c(-1),children:"Poništi"}),e.jsx(k,{$bg:"green",type:"submit",children:"Sačuvaj"}),e.jsx(k,{$bg:"red",type:"button",onClick:()=>v(!0),children:"Obriši"}),w&&e.jsx(Z,{setShowModal:v,id:o})]})}function le(){return e.jsxs(O,{children:[e.jsx(U,{children:"Izmena članka"}),e.jsxs(q,{children:[e.jsx(ee,{}),e.jsxs(J,{children:[e.jsx("h4",{children:"Uputstvo za formatiranje"}),e.jsx("br",{}),e.jsx("p",{children:"## Podnaslov"}),e.jsx("br",{}),e.jsx("p",{children:"### Podpodnaslov"}),e.jsx("br",{}),e.jsx("p",{children:"Tekst"}),e.jsx("br",{}),e.jsxs("p",{children:["(",e.jsx("i",{children:"postavljanje slike"}),")"]}),e.jsx("p",{children:"|     |"}),e.jsx("p",{children:"|:---:|"}),e.jsxs("p",{children:["|![",e.jsx("i",{children:"opis slike"}),"](",e.jsx("i",{children:"link ka slici"}),")|"]}),e.jsxs("p",{children:["|",e.jsx("i",{children:"naslov slike"}),"|"]}),e.jsx("br",{}),e.jsxs("p",{children:["(",e.jsx("i",{children:"linkovanje"}),")"]}),e.jsxs("p",{children:["[",e.jsx("i",{children:"tekst linka"}),"](",e.jsx("i",{children:"/articles/:id"}),")"]})]})]})]})}export{le as default};
